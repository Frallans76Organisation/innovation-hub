<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idé- och Behovshubben</title>
    <meta name="description" content="Samla in, analysera och utveckla medarbetarnas idéer till framtidens tjänster">

    <link rel="stylesheet" href="/static/css/main.css">

    <!-- Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <header class="header">
        <div class="container">
            <h1><i class="fas fa-lightbulb"></i> Idé- och Behovshubben</h1>
            <p>Samla in, analysera och utveckla medarbetarnas idéer till framtidens tjänster</p>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <!-- Navigation Tabs -->
            <nav class="nav-tabs">
                <button class="nav-tab active" data-tab="dashboard">
                    <i class="fas fa-clock"></i> Senaste Idéer
                </button>
                <button class="nav-tab" data-tab="submit">
                    <i class="fas fa-plus-circle"></i> Lämna Idé
                </button>
                <button class="nav-tab" data-tab="browse">
                    <i class="fas fa-list"></i> Bläddra Idéer
                </button>
                <button class="nav-tab" data-tab="analysis">
                    <i class="fas fa-brain"></i> Analys
                </button>
                <button class="nav-tab" data-tab="projects">
                    <i class="fas fa-project-diagram"></i> Projekt
                </button>
                <button class="nav-tab" data-tab="documents">
                    <i class="fas fa-folder-open"></i> Dokument
                </button>
                <button class="nav-tab" data-tab="strategy">
                    <i class="fas fa-sitemap"></i> Strategi
                </button>
                <button class="nav-tab" data-tab="funding">
                    <i class="fas fa-euro-sign"></i> Utlysningar
                </button>
            </nav>

            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="card">
                    <h2><i class="fas fa-lightbulb"></i> Senaste Idéer</h2>
                    <p style="color: var(--neutral-gray); margin-bottom: var(--space-lg);">
                        De 20 senast inlämnade idéerna och förslagen från medarbetare.
                    </p>
                    <div id="recentIdeas">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Submit Idea Section -->
            <section id="submit" class="content-section">
                <div class="card">
                    <h2>Lämna en Idé</h2>

                    <div id="submitSuccess" class="success" style="display: none;">
                        <i class="fas fa-check-circle"></i> Idén har lämnats in framgångsrikt!
                    </div>

                    <div id="submitError" class="error" style="display: none;">
                        <i class="fas fa-exclamation-triangle"></i> Ett fel uppstod. Försök igen.
                    </div>

                    <form id="ideaForm">
                        <div class="form-group">
                            <label for="title" class="form-label">Titel *</label>
                            <input type="text" id="title" name="title" class="form-control"
                                   placeholder="Kortfattad beskrivning av din idé" required>
                        </div>

                        <div class="form-group">
                            <label for="description" class="form-label">Beskrivning *</label>
                            <textarea id="description" name="description" class="form-control"
                                      placeholder="Beskriv din idé i detalj. Vad är problemet du vill lösa? Hur skulle din lösning fungera?" required></textarea>
                        </div>

                        <div class="form-group">
                            <label for="type" class="form-label">Typ *</label>
                            <select id="type" name="type" class="form-control" required>
                                <option value="">Välj typ</option>
                                <option value="idé">Idé - Ny lösning eller förbättring</option>
                                <option value="problem">Problem - Något som behöver lösas</option>
                                <option value="behov">Behov - Något som saknas</option>
                                <option value="förbättring">Förbättring - Utveckling av befintligt</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="targetGroup" class="form-label">Målgrupp *</label>
                            <select id="targetGroup" name="target_group" class="form-control" required>
                                <option value="">Vem gynnas mest av detta?</option>
                                <option value="medborgare">Medborgare</option>
                                <option value="företag">Företag</option>
                                <option value="medarbetare">Medarbetare</option>
                                <option value="andra organisationer">Andra organisationer</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="submitterEmail" class="form-label">Din e-post *</label>
                            <input type="email" id="submitterEmail" name="submitter_email" class="form-control"
                                   placeholder="din.email@kommun.se" required>
                        </div>

                        <div class="form-group">
                            <label for="tags" class="form-label">Taggar (valfritt)</label>
                            <input type="text" id="tags" name="tags" class="form-control"
                                   placeholder="digitalisering, ai, automation (separera med komma)">
                            <small style="color: var(--neutral-gray); font-size: var(--font-size-sm);">
                                Lägg till relevanta nyckelord för att göra din idé lättare att hitta
                            </small>
                        </div>

                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i>
                            Skicka Idé
                        </button>
                    </form>
                </div>
            </section>

            <!-- Browse Ideas Section -->
            <section id="browse" class="content-section">
                <div class="card">
                    <h2>Alla Idéer</h2>

                    <!-- Filters -->
                    <div class="filters">
                        <h3>Filter</h3>
                        <div class="filters-grid">
                            <div class="form-group">
                                <label for="filterStatus" class="form-label">Status</label>
                                <select id="filterStatus" class="form-control">
                                    <option value="">Alla statusar</option>
                                    <option value="ny">Ny</option>
                                    <option value="granskning">Granskning</option>
                                    <option value="godkänd">Godkänd</option>
                                    <option value="utveckling">Utveckling</option>
                                    <option value="implementerad">Implementerad</option>
                                    <option value="avvisad">Avvisad</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="filterType" class="form-label">Typ</label>
                                <select id="filterType" class="form-control">
                                    <option value="">Alla typer</option>
                                    <option value="idé">Idé</option>
                                    <option value="problem">Problem</option>
                                    <option value="behov">Behov</option>
                                    <option value="förbättring">Förbättring</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="filterSearch" class="form-label">Sök</label>
                                <input type="text" id="filterSearch" class="form-control"
                                       placeholder="Sök i titel och beskrivning">
                            </div>

                            <div class="form-group">
                                <label class="form-label">&nbsp;</label>
                                <button id="applyFilters" class="btn btn-primary">
                                    <i class="fas fa-filter"></i>
                                    Filtrera
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Ideas List -->
                    <div id="ideasList" class="idea-list">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Manage Ideas Section -->
            <!-- Analysis Section -->
            <section id="analysis" class="content-section">
                <!-- Service Mapping Overview -->
                <div class="card">
                    <h2><i class="fas fa-brain"></i> AI-driven Tjänstemappning</h2>
                    <p style="color: var(--neutral-gray); margin-bottom: var(--space-lg);">
                        Se hur dina idéer mappar mot befintliga tjänster och var det finns utvecklingsbehov.
                    </p>

                    <div id="serviceMappingOverview" class="service-mapping-grid">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>

                <!-- Development Needs Matrix -->
                <div class="card">
                    <h3><i class="fas fa-chart-scatter"></i> Utvecklingsbehov Matrix</h3>
                    <p style="color: var(--neutral-gray); font-size: 0.9rem; margin-bottom: var(--space-md);">
                        Prioritera idéer baserat på matchning mot befintliga tjänster och strategisk påverkan.
                    </p>
                    <div id="developmentMatrix">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>

                <!-- Top Matched Services -->
                <div class="card">
                    <h3><i class="fas fa-trophy"></i> Mest Matchade Tjänster</h3>
                    <p style="color: var(--neutral-gray); font-size: 0.9rem; margin-bottom: var(--space-md);">
                        Tjänster som får flest utvecklingsförslag från medarbetare.
                    </p>
                    <div id="topMatchedServices">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>

                <!-- Gap Analysis -->
                <div class="card">
                    <h3><i class="fas fa-exclamation-triangle"></i> Gap-analys</h3>
                    <p style="color: var(--neutral-gray); font-size: 0.9rem; margin-bottom: var(--space-md);">
                        Områden med många idéer men ingen befintlig tjänst - strategiska utvecklingsmöjligheter.
                    </p>
                    <div id="gapAnalysis">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>

                <!-- AI Confidence -->
                <div class="card">
                    <h3><i class="fas fa-robot"></i> AI-analys Tillförlitlighet</h3>
                    <div id="aiConfidence">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>

                <!-- AI Analysis Transparency -->
                <div class="card">
                    <h3><i class="fas fa-microscope"></i> AI-analys Transparens</h3>
                    <p style="color: var(--neutral-gray); font-size: 0.9rem; margin-bottom: var(--space-md);">
                        Se hur AI:n har analyserat och kategoriserat varje idé.
                    </p>
                    <div id="aiTransparency">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Projects Section -->
            <section id="projects" class="content-section">
                <!-- Project Stats -->
                <div class="card">
                    <h2><i class="fas fa-project-diagram"></i> Utvecklingsprojekt</h2>
                    <p style="color: var(--neutral-gray); margin-bottom: var(--space-lg);">
                        Hantera utvecklingsprojekt och koppla dem till inkomna idéer och behov.
                    </p>

                    <div id="projectStats" class="stats-grid">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>

                <!-- Create Project Card -->
                <div class="card">
                    <h3><i class="fas fa-plus-circle"></i> Skapa nytt projekt</h3>

                    <div id="projectSuccess" class="success" style="display: none;">
                        <i class="fas fa-check-circle"></i> Projektet har skapats!
                    </div>

                    <div id="projectError" class="error" style="display: none;">
                        <i class="fas fa-exclamation-triangle"></i> Ett fel uppstod. Försök igen.
                    </div>

                    <form id="projectForm">
                        <div class="form-row">
                            <div class="form-group" style="flex: 2;">
                                <label for="projectName" class="form-label">Projektnamn *</label>
                                <input type="text" id="projectName" name="name" class="form-control"
                                       placeholder="T.ex. Digital medborgarportal" required>
                            </div>

                            <div class="form-group" style="flex: 1;">
                                <label for="projectType" class="form-label">Projekttyp *</label>
                                <select id="projectType" name="project_type" class="form-control" required>
                                    <option value="">Välj typ</option>
                                    <option value="intern_utveckling">Intern utveckling</option>
                                    <option value="vinnova">Vinnova-projekt</option>
                                    <option value="eu_finansierad">EU-finansierat</option>
                                    <option value="externt_samarbete">Externt samarbete</option>
                                    <option value="förvaltning">Förvaltning/Drift</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="projectDescription" class="form-label">Beskrivning *</label>
                            <textarea id="projectDescription" name="description" class="form-control"
                                      placeholder="Beskriv projektet, dess mål och förväntade nytta" required></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="projectDepartment" class="form-label">Ansvarig avdelning</label>
                                <input type="text" id="projectDepartment" name="owner_department" class="form-control"
                                       placeholder="T.ex. IT-avdelningen">
                            </div>

                            <div class="form-group">
                                <label for="projectManager" class="form-label">Projektledare</label>
                                <input type="text" id="projectManager" name="project_manager" class="form-control"
                                       placeholder="Namn på projektledare">
                            </div>

                            <div class="form-group">
                                <label for="projectEmail" class="form-label">Kontakt e-post</label>
                                <input type="email" id="projectEmail" name="contact_email" class="form-control"
                                       placeholder="projekt@kommun.se">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="projectBudget" class="form-label">Budget (SEK)</label>
                                <input type="number" id="projectBudget" name="estimated_budget" class="form-control"
                                       placeholder="0" min="0">
                            </div>

                            <div class="form-group">
                                <label for="projectFunding" class="form-label">Finansieringskälla</label>
                                <input type="text" id="projectFunding" name="funding_source" class="form-control"
                                       placeholder="T.ex. Vinnova, EU Horizon">
                            </div>

                            <div class="form-group">
                                <label for="projectStart" class="form-label">Planerad start</label>
                                <input type="date" id="projectStart" name="planned_start" class="form-control">
                            </div>

                            <div class="form-group">
                                <label for="projectEnd" class="form-label">Planerat slut</label>
                                <input type="date" id="projectEnd" name="planned_end" class="form-control">
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Skapa Projekt
                        </button>
                    </form>
                </div>

                <!-- Project List Card -->
                <div class="card">
                    <h3><i class="fas fa-list"></i> Alla Projekt</h3>

                    <!-- Project Filters -->
                    <div class="filters" style="margin-bottom: var(--space-lg);">
                        <div class="filters-grid">
                            <div class="form-group">
                                <label for="projectFilterStatus" class="form-label">Status</label>
                                <select id="projectFilterStatus" class="form-control">
                                    <option value="">Alla statusar</option>
                                    <option value="föreslagen">Föreslagen</option>
                                    <option value="planering">Planering</option>
                                    <option value="pågående">Pågående</option>
                                    <option value="pausad">Pausad</option>
                                    <option value="avslutad">Avslutad</option>
                                    <option value="avbruten">Avbruten</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="projectFilterType" class="form-label">Typ</label>
                                <select id="projectFilterType" class="form-control">
                                    <option value="">Alla typer</option>
                                    <option value="intern_utveckling">Intern utveckling</option>
                                    <option value="vinnova">Vinnova</option>
                                    <option value="eu_finansierad">EU-finansierat</option>
                                    <option value="externt_samarbete">Externt samarbete</option>
                                    <option value="förvaltning">Förvaltning</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="projectFilterSearch" class="form-label">Sök</label>
                                <input type="text" id="projectFilterSearch" class="form-control"
                                       placeholder="Sök i namn och beskrivning">
                            </div>

                            <div class="form-group">
                                <label class="form-label">&nbsp;</label>
                                <button id="applyProjectFilters" class="btn btn-primary">
                                    <i class="fas fa-filter"></i> Filtrera
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="projectList">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Documents Section -->
            <section id="documents" class="content-section">
                <!-- Upload Card -->
                <div class="card">
                    <h2><i class="fas fa-upload"></i> Ladda upp Dokument</h2>
                    <p style="color: var(--neutral-gray); margin-bottom: var(--space-lg);">
                        Ladda upp tjänstebeskrivningar och dokumentation för att förbättra AI-matchning.
                        Stödjer: PDF, Word, Excel, Text.
                    </p>

                    <div class="upload-area" id="uploadArea">
                        <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--secondary-blue); margin-bottom: var(--space-md);"></i>
                        <h3>Dra och släpp filer här</h3>
                        <p>eller</p>
                        <label for="fileInput" class="btn btn-primary" style="cursor: pointer;">
                            <i class="fas fa-folder-open"></i> Välj filer
                        </label>
                        <input type="file" id="fileInput" multiple accept=".pdf,.docx,.doc,.xlsx,.xls,.txt" style="display: none;">
                        <small style="color: var(--neutral-gray); margin-top: var(--space-md); display: block;">
                            Max 10MB per fil. Stöd för: PDF, DOCX, XLSX, TXT
                        </small>
                    </div>

                    <!-- Upload Progress -->
                    <div id="uploadProgress" style="display: none; margin-top: var(--space-lg);">
                        <div class="upload-item">
                            <div class="upload-info">
                                <strong id="uploadFileName">filnamn.pdf</strong>
                                <span id="uploadStatus">Laddar upp...</span>
                            </div>
                            <div class="progress-bar-container" style="margin-top: var(--space-sm);">
                                <div class="progress-bar" id="uploadProgressBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Upload Results -->
                    <div id="uploadResults" style="margin-top: var(--space-lg);"></div>
                </div>

                <!-- RAG Stats Card -->
                <div class="card">
                    <h3><i class="fas fa-chart-bar"></i> RAG-statistik</h3>
                    <div id="ragStats">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>

                <!-- Document List Card -->
                <div class="card">
                    <h3><i class="fas fa-list"></i> Uppladdade Dokument</h3>
                    <div id="documentList">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Strategy Section -->
            <section id="strategy" class="content-section">
                <!-- Strategy Stats -->
                <div class="card stats-grid" id="strategyStats">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>

                <!-- Create Strategy Document -->
                <div class="card">
                    <h2><i class="fas fa-plus-circle"></i> Skapa Strategidokument</h2>

                    <form id="strategyForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="strategyTitle" class="form-label">Titel *</label>
                                <input type="text" id="strategyTitle" name="title" class="form-control"
                                       placeholder="T.ex. Strategiskt mål: Digital tillgänglighet" required>
                            </div>

                            <div class="form-group">
                                <label for="strategyType" class="form-label">Dokumenttyp *</label>
                                <select id="strategyType" name="document_type" class="form-control" required>
                                    <option value="stratsys_mål">Stratsys-mål</option>
                                    <option value="vision">Vision</option>
                                    <option value="policy">Policy</option>
                                    <option value="riktlinje">Riktlinje</option>
                                    <option value="handlingsplan">Handlingsplan</option>
                                    <option value="budgetmål">Budgetmål</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="strategyDescription" class="form-label">Beskrivning</label>
                            <textarea id="strategyDescription" name="description" class="form-control" rows="3"
                                      placeholder="Beskriv målet eller dokumentets syfte..."></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="strategyLevel" class="form-label">Nivå</label>
                                <select id="strategyLevel" name="level" class="form-control">
                                    <option value="1">1 - Strategisk</option>
                                    <option value="2">2 - Taktisk/Delmål</option>
                                    <option value="3">3 - Operativ/Aktivitet</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="strategyDepartment" class="form-label">Ansvarig avdelning</label>
                                <input type="text" id="strategyDepartment" name="responsible_department"
                                       class="form-control" placeholder="T.ex. IT-avdelningen">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="strategyPerson" class="form-label">Ansvarig person</label>
                                <input type="text" id="strategyPerson" name="responsible_person"
                                       class="form-control" placeholder="T.ex. Anna Andersson">
                            </div>

                            <div class="form-group">
                                <label for="strategyPeriod" class="form-label">Tidsperiod</label>
                                <input type="text" id="strategyPeriod" name="time_period"
                                       class="form-control" placeholder="T.ex. 2024-2027">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="strategyKeywords" class="form-label">Nyckelord</label>
                            <input type="text" id="strategyKeywords" name="keywords" class="form-control"
                                   placeholder="Kommaseparerade, t.ex. digitalisering, e-tjänster, tillgänglighet">
                        </div>

                        <div id="strategySuccess" class="success" style="display: none;"></div>
                        <div id="strategyError" class="error" style="display: none;"></div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Skapa Strategidokument
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="loadSampleStrategy()">
                                <i class="fas fa-database"></i> Ladda Exempeldata
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Coverage Report -->
                <div class="card">
                    <h3><i class="fas fa-chart-pie"></i> Strategitäckning</h3>
                    <div id="coverageReport">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>

                <!-- Strategy Tree -->
                <div class="card">
                    <div class="card-header-actions">
                        <h3><i class="fas fa-sitemap"></i> Strategisk Struktur</h3>
                        <div class="tree-controls">
                            <button class="btn btn-sm btn-secondary" onclick="expandAllNodes()">
                                <i class="fas fa-expand-alt"></i> Expandera alla
                            </button>
                            <button class="btn btn-sm btn-secondary" onclick="collapseAllNodes()">
                                <i class="fas fa-compress-alt"></i> Kollappa alla
                            </button>
                        </div>
                    </div>
                    <div id="strategyTree">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Funding Section -->
            <section id="funding" class="content-section">
                <!-- Stats -->
                <div id="funding-stats" class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">-</div>
                        <div class="stat-label">Laddar...</div>
                    </div>
                </div>

                <!-- Upcoming Deadlines -->
                <div id="upcoming-deadlines" class="card" style="margin-top: var(--space-lg);">
                    <h4>Kommande deadlines</h4>
                    <div class="loading"><div class="spinner"></div></div>
                </div>

                <!-- Filters and Search -->
                <div class="card" style="margin-top: var(--space-lg);">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label>Källa:</label>
                            <button class="filter-btn active" data-filter="source" data-value="">Alla</button>
                            <button class="filter-btn" data-filter="source" data-value="vinnova">Vinnova</button>
                            <button class="filter-btn" data-filter="source" data-value="eu_horizon">EU Horizon</button>
                            <button class="filter-btn" data-filter="source" data-value="eu_digital">EU Digital</button>
                            <button class="filter-btn" data-filter="source" data-value="regional">Regional</button>
                        </div>
                        <div class="filter-group">
                            <label>Status:</label>
                            <button class="filter-btn active" data-filter="status" data-value="">Alla</button>
                            <button class="filter-btn" data-filter="status" data-value="öppen">Öppen</button>
                            <button class="filter-btn" data-filter="status" data-value="kommande">Kommande</button>
                            <button class="filter-btn" data-filter="status" data-value="stängd">Stängd</button>
                        </div>
                        <div class="search-group">
                            <input type="text" id="funding-search" class="form-control" placeholder="Sök utlysningar...">
                        </div>
                    </div>
                </div>

                <!-- Funding List -->
                <div id="funding-list" style="margin-top: var(--space-lg);">
                    <div class="loading"><div class="spinner"></div></div>
                </div>

                <!-- Create New Funding Call -->
                <div class="card" style="margin-top: var(--space-xl);">
                    <h3><i class="fas fa-plus-circle"></i> Lägg till utlysning</h3>
                    <form id="funding-form">
                        <div class="form-row">
                            <div class="form-group" style="flex: 2;">
                                <label for="funding-title" class="form-label">Titel *</label>
                                <input type="text" id="funding-title" name="title" class="form-control" required>
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label for="funding-source" class="form-label">Källa *</label>
                                <select id="funding-source" name="source" class="form-control" required>
                                    <option value="vinnova">Vinnova</option>
                                    <option value="eu_horizon">EU Horizon</option>
                                    <option value="eu_digital">EU Digital</option>
                                    <option value="regional">Regional</option>
                                    <option value="other">Övrig</option>
                                </select>
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label for="funding-status" class="form-label">Status</label>
                                <select id="funding-status" name="status" class="form-control">
                                    <option value="kommande">Kommande</option>
                                    <option value="öppen">Öppen</option>
                                    <option value="stänger_snart">Stänger snart</option>
                                    <option value="stängd">Stängd</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="funding-description" class="form-label">Beskrivning</label>
                            <textarea id="funding-description" name="description" class="form-control" rows="3"></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="funding-deadline" class="form-label">Deadline</label>
                                <input type="date" id="funding-deadline" name="deadline" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="funding-total-budget" class="form-label">Total budget (SEK)</label>
                                <input type="number" id="funding-total-budget" name="total_budget" class="form-control" min="0">
                            </div>
                            <div class="form-group">
                                <label for="funding-min-grant" class="form-label">Min bidrag (SEK)</label>
                                <input type="number" id="funding-min-grant" name="min_grant" class="form-control" min="0">
                            </div>
                            <div class="form-group">
                                <label for="funding-max-grant" class="form-label">Max bidrag (SEK)</label>
                                <input type="number" id="funding-max-grant" name="max_grant" class="form-control" min="0">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="funding-cofunding" class="form-label">Medfinansiering (%)</label>
                                <input type="number" id="funding-cofunding" name="co_funding_requirement" class="form-control" min="0" max="100">
                            </div>
                            <div class="form-group" style="flex: 2;">
                                <label for="funding-url" class="form-label">Extern länk</label>
                                <input type="url" id="funding-url" name="external_url" class="form-control" placeholder="https://...">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="funding-focus" class="form-label">Fokusområden (kommaseparerade)</label>
                            <input type="text" id="funding-focus" name="focus_areas" class="form-control" placeholder="digitalisering, hållbarhet, AI">
                        </div>

                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Lägg till utlysning
                        </button>
                    </form>
                </div>

                <!-- Funding Modal -->
                <div id="funding-modal" class="modal" style="display: none;">
                    <div class="modal-content" style="max-width: 800px;">
                        <!-- Content populated by JS -->
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Edit Idea Modal -->
    <div id="editModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-edit"></i> Redigera Idé</h2>
                <button class="modal-close" onclick="closeEditModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editIdeaForm">
                    <input type="hidden" id="editIdeaId">

                    <div class="form-group">
                        <label for="editTitle" class="form-label">Titel *</label>
                        <input type="text" id="editTitle" name="title" class="form-control" required>
                    </div>

                    <div class="form-group">
                        <label for="editDescription" class="form-label">Beskrivning *</label>
                        <textarea id="editDescription" name="description" class="form-control" rows="6" required></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="editType" class="form-label">Typ *</label>
                            <select id="editType" name="type" class="form-control" required>
                                <option value="idé">Idé</option>
                                <option value="problem">Problem</option>
                                <option value="behov">Behov</option>
                                <option value="förbättring">Förbättring</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="editTargetGroup" class="form-label">Målgrupp *</label>
                            <select id="editTargetGroup" name="target_group" class="form-control" required>
                                <option value="medborgare">Medborgare</option>
                                <option value="företag">Företag</option>
                                <option value="medarbetare">Medarbetare</option>
                                <option value="andra_organisationer">Andra organisationer</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <input type="checkbox" id="editReanalyze" checked>
                            Kör AI-analys igen efter uppdatering
                        </label>
                        <small style="display: block; color: var(--neutral-gray); margin-top: var(--space-xs);">
                            Rekommenderas om du ändrat titel eller beskrivning
                        </small>
                    </div>

                    <div id="editError" class="error" style="display: none; margin-bottom: var(--space-md);"></div>
                    <div id="editSuccess" class="success" style="display: none; margin-bottom: var(--space-md);"></div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="closeEditModal()">
                            Avbryt
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Spara ändringar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="/static/js/api.js"></script>
    <script src="/static/js/ui.js"></script>
    <script src="/static/js/analysis.js"></script>
    <script src="/static/js/documents.js"></script>
    <script src="/static/js/projects.js"></script>
    <script src="/static/js/strategy.js"></script>
    <script src="/static/js/funding.js"></script>
    <script src="/static/js/edit.js"></script>
    <script src="/static/js/voting.js"></script>
    <script src="/static/js/main.js"></script>
</body>
</html>